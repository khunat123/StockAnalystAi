Step 1: User Input
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
     ğŸ‘¤ User à¸à¸´à¸¡à¸à¹Œ: "à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ AAPL"
           â”‚
           â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚    Chat-UI      â”‚ â”€â”€â–º POST /v1/chat/completions
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     (stream: true)
           â”‚
           â–¼
Step 2: Ticker Extraction
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ extract_ticker()â”‚ â”€â”€â–º à¸”à¸¶à¸‡ "AAPL" à¸ˆà¸²à¸à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
Step 3: PHASE 1 - Data Collection (Parallel)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚            ThreadPoolExecutor (à¸£à¸±à¸™à¸à¸£à¹‰à¸­à¸¡à¸à¸±à¸™)          â”‚
     â”‚                                                     â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
     â”‚  â”‚  Market    â”‚  â”‚ Fundament  â”‚  â”‚   News     â”‚    â”‚
     â”‚  â”‚  Analyst   â”‚  â”‚  Analyst   â”‚  â”‚  Analyst   â”‚    â”‚
     â”‚  â”‚  (yfinance)â”‚  â”‚ (yfinance) â”‚  â”‚  (Tavily)  â”‚    â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
     â”‚                                                     â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
     â”‚  â”‚  Social    â”‚  â”‚   Risk     â”‚                    â”‚
     â”‚  â”‚  Analyst   â”‚  â”‚  Analyst   â”‚                    â”‚
     â”‚  â”‚  (Tavily)  â”‚  â”‚ (yfinance) â”‚                    â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ (à¸£à¸§à¸¡ Data à¸ˆà¸²à¸ 5 Analysts)
           
Step 4: PHASE 2 - Bull vs Bear Research
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                      â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
     â”‚  â”‚    ğŸ‚      â”‚    â”‚    ğŸ»      â”‚   â”‚
     â”‚  â”‚   Bull     â”‚ VS â”‚   Bear     â”‚   â”‚
     â”‚  â”‚ Researcher â”‚    â”‚ Researcher â”‚   â”‚
     â”‚  â”‚ (à¸¡à¸­à¸‡à¸šà¸§à¸)    â”‚    â”‚ (à¸¡à¸­à¸‡à¸¥à¸š)     â”‚   â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
     â”‚                                      â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
Step 5: PHASE 3 - Debate Moderation
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   âš–ï¸ Debate Moderator  â”‚
     â”‚   à¸•à¸±à¸”à¸ªà¸´à¸™à¸§à¹ˆà¸²à¸à¸±à¹ˆà¸‡à¹„à¸«à¸™à¸¡à¸µà¹€à¸«à¸•à¸¸à¸œà¸¥  â”‚
     â”‚   à¸«à¸™à¸±à¸à¹à¸™à¹ˆà¸™à¸à¸§à¹ˆà¸²            â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
Step 6: PHASE 4 - Risk Assessment
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                     â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
     â”‚  â”‚  Risky  â”‚â”‚ Neutral â”‚â”‚ Conserv â”‚ â”‚
     â”‚  â”‚ Debator â”‚â”‚ Debator â”‚â”‚ Debator â”‚ â”‚
     â”‚  â”‚ "à¸¥à¸¸à¸¢à¹€à¸¥à¸¢!" â”‚â”‚ "à¸à¸¥à¸²à¸‡à¹†"  â”‚â”‚ "à¸£à¸°à¸§à¸±à¸‡!" â”‚ â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
     â”‚               â”‚                     â”‚
     â”‚               â–¼                     â”‚
     â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
     â”‚       â”‚ Risk Judge  â”‚              â”‚
     â”‚       â”‚ à¸•à¸±à¸”à¸ªà¸´à¸™à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡ â”‚              â”‚
     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
Step 7: PHASE 5 - Final Decision
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚    ğŸ’¼ Portfolio Manager â”‚
     â”‚                         â”‚
     â”‚   à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸à¸—à¸¸à¸à¸à¹ˆà¸²à¸¢:      â”‚
     â”‚   - 5 Analysts          â”‚
     â”‚   - Bull/Bear           â”‚
     â”‚   - Debate Result       â”‚
     â”‚   - Risk Judgment       â”‚
     â”‚                         â”‚
     â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
     â”‚   â”‚  à¸Ÿà¸±à¸™à¸˜à¸‡:          â”‚   â”‚
     â”‚   â”‚  BUY / SELL /   â”‚   â”‚
     â”‚   â”‚  HOLD           â”‚   â”‚
     â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
Step 8: Stream Response
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  build_report()     â”‚
     â”‚  à¸ªà¸£à¹‰à¸²à¸‡à¸£à¸²à¸¢à¸‡à¸²à¸™à¹€à¸›à¹‡à¸™ MD   â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ SSE Streaming (à¸—à¸µà¸¥à¸° chunk)
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚     Chat-UI         â”‚
     â”‚  à¹à¸ªà¸”à¸‡à¸œà¸¥à¸—à¸µà¸¥à¸°à¸•à¸±à¸§à¸­à¸±à¸à¸©à¸£    â”‚
     â”‚  (Real-time)        â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
Step 9: Save to MongoDB
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   ğŸ—„ï¸ MongoDB        â”‚
     â”‚   à¹€à¸à¹‡à¸š report à¹„à¸§à¹‰à¹ƒà¸Šà¹‰  â”‚
     â”‚   à¸–à¸²à¸¡à¸–à¸²à¸¡à¹€à¸à¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡à¹„à¸”à¹‰   â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜